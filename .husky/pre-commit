#!/usr/bin/env sh
cd "$(dirname "$0")/.." || exit

# Run lint-staged and capture output
ERROR_LOG=".husky-errors.log"
npx lint-staged 2>&1 | tee "$ERROR_LOG"

# Check if lint-staged failed
if [ $? -ne 0 ]; then
  echo ""
  echo "âŒ Pre-commit hook failed!"
  echo "ğŸ“„ Detailed errors saved to: $ERROR_LOG"
  echo "ğŸ’¡ Open the file to see full error details"
  exit 1
fi

# Remove error log if successful
rm -f "$ERROR_LOG"
exit 0
